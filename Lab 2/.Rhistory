knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
# Core packages for DAGs
# install.packages(c("dagitty", "ggdag", "tidyverse"))
library(dagitty)
library(ggdag)
library(tidyverse)
dag_med <- dagitty("dag {
X -> Z -> Y
}")
ggdag(dag_med) + theme_dag()
# dagify version for better styling
dag_med <- dagify(
Z ~ X,
Y ~ Z,
exposure = "X",
outcome  = "Y",
labels = c(X = "X", Y = "Y", Z = "Z")
)
# Add styling for better visualization
ggdag(dag_med, text = TRUE) +
geom_dag_edges(edge_width = 1.3) +
geom_dag_point(size = 11) +
geom_dag_text(color = "white", size = 5) +
theme_dag() +
theme(
plot.margin = margin(20, 20, 20, 20),
plot.title = element_text(face = "bold")
) +
ggtitle("Mediator: conditioning on Z blocks the path from X to Y")
impliedConditionalIndependencies(dag_med)
# Check d-separation explicitly:
dseparated(dag_med, "X", "Y")                 # FALSE (dependent)
dseparated(dag_med, "X", "Y", "Z")            # TRUE  (independent given Z)
dag_confound <- dagitty("dag {
Z -> X
Z -> Y
}")
ggdag(dag_confound) + theme_dag()
# dagify version for better styling
dag_confound <- dagify(
X ~ Z,
Y ~ Z,
exposure = "X",
outcome  = "Y",
labels = c(X = "X", Y = "Y", Z = "Z")
)
# Add styling for better visualization
ggdag(dag_confound, text = TRUE) +
geom_dag_edges(edge_width = 1.3) +
geom_dag_point(size = 11) +
geom_dag_text(color = "white", size = 5) +
theme_dag() +
theme(
plot.margin = margin(20, 20, 20, 20),
plot.title = element_text(face = "bold")
) +
ggtitle("Confounder: conditioning on Z blocks the backdoor path between X and Y")
impliedConditionalIndependencies(dag_confound)
dseparated(dag_confound, "X", "Y")         # FALSE (dependent)
dseparated(dag_confound, "X", "Y", "Z")    # TRUE  (independent given Z)
ggdag_adjustment_set(dag_confound, node_size = 20) +
theme_dag()
dag_collider <- dagitty("dag {
X -> Z
Y -> Z
}")
ggdag(dag_collider) + theme_dag()
# dagify version for better styling
dag_collider <- dagify(
Z ~ X + Y,
exposure = "X",
outcome  = "Y",
labels = c(X = "X", Y = "Y", Z = "Z")
)
# Add styling for better visualization
ggdag(dag_collider, text = TRUE) +
geom_dag_edges(edge_width = 1.3) +
geom_dag_point(size = 11) +
geom_dag_text(color = "white", size = 5) +
theme_dag() +
theme(
plot.margin = margin(20, 20, 20, 20),
plot.title = element_text(face = "bold")
) +
ggtitle("Collider: conditioning on Z opens association between X and Y")
impliedConditionalIndependencies(dag_collider)
dseparated(dag_collider, "X", "Y")          # TRUE  (independent)
dseparated(dag_collider, "X", "Y", "Z")     # FALSE (dependent given Z)
# In a chain, Z is not a valid adjustment set for the total effect of X on Y (it blocks the path).
adjustmentSets(dag_med, exposure = "X", outcome = "Y")
# In a fork, Z is a valid adjustment set for the effect of X on Y.
adjustmentSets(dag_confound, exposure = "X", outcome = "Y")
# In a collider, there are no valid adjustment sets for the effect of X on Y (conditioning on Z creates bias).
adjustmentSets(dag_collider, exposure = "X", outcome = "Y")
dag_complex1 <- dagitty("dag {
D -> M -> Y
U -> D
U -> Y
}")
ggdag(dag_complex1) + theme_dag()
impliedConditionalIndependencies(dag_complex1)
adjustmentSets(dag_complex1, exposure = "D", outcome = "Y")
